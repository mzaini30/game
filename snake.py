import base64
exec(base64.b64decode('aW1wb3J0IGN1cnNlcwpmcm9tIGN1cnNlcyBpbXBvcnQgS0VZX1JJR0hULCBLRVlfTEVGVCwgS0VZX1VQLCBLRVlfRE9XTgpmcm9tIHJhbmRvbSBpbXBvcnQgcmFuZGludAoKCmN1cnNlcy5pbml0c2NyKCkKd2luID0gY3Vyc2VzLm5ld3dpbigyMCwgNjAsIDAsIDApCndpbi5rZXlwYWQoMSkKY3Vyc2VzLm5vZWNobygpCmN1cnNlcy5jdXJzX3NldCgwKQp3aW4uYm9yZGVyKDApCndpbi5ub2RlbGF5KDEpCgprZXkgPSBLRVlfUklHSFQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCnNjb3JlID0gMAoKc25ha2UgPSBbWzQsMTBdLCBbNCw5XSwgWzQsOF1dICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIApmb29kID0gWzEwLDIwXSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCndpbi5hZGRjaChmb29kWzBdLCBmb29kWzFdLCAnKicpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAp3aGlsZSBrZXkgIT0gMjc6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICB3aW4uYm9yZGVyKDApCiAgICB3aW4uYWRkc3RyKDAsIDIsICdTY29yZSA6ICcgKyBzdHIoc2NvcmUpICsgJyAnKSAgICAgICAgICAgICAgIAogICAgd2luLmFkZHN0cigwLCAyNywgJyBTTkFLRSAnKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICB3aW4udGltZW91dCgxNTAgLSAobGVuKHNuYWtlKS81ICsgbGVuKHNuYWtlKS8xMCklMTIwKSAgICAgICAgICAKICAgIAogICAgcHJldktleSA9IGtleSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICBldmVudCA9IHdpbi5nZXRjaCgpCiAgICBrZXkgPSBrZXkgaWYgZXZlbnQgPT0gLTEgZWxzZSBldmVudCAKCgogICAgaWYga2V5ID09IG9yZCgnICcpOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICBrZXkgPSAtMSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgd2hpbGUga2V5ICE9IG9yZCgnICcpOgogICAgICAgICAgICBrZXkgPSB3aW4uZ2V0Y2goKQogICAgICAgIGtleSA9IHByZXZLZXkKICAgICAgICBjb250aW51ZQoKICAgIGlmIGtleSBub3QgaW4gW0tFWV9MRUZULCBLRVlfUklHSFQsIEtFWV9VUCwgS0VZX0RPV04sIDI3XTogICAgIAogICAgICAgIGtleSA9IHByZXZLZXkKCgogICAgc25ha2UuaW5zZXJ0KDAsIFtzbmFrZVswXVswXSArIChrZXkgPT0gS0VZX0RPV04gYW5kIDEpICsgKGtleSA9PSBLRVlfVVAgYW5kIC0xKSwgc25ha2VbMF1bMV0gKyAoa2V5ID09IEtFWV9MRUZUIGFuZCAtMSkgKyAoa2V5ID09IEtFWV9SSUdIVCBhbmQgMSldKQoKICAgIAogICAgaWYgc25ha2VbMF1bMF0gPT0gMDogc25ha2VbMF1bMF0gPSAxOAogICAgaWYgc25ha2VbMF1bMV0gPT0gMDogc25ha2VbMF1bMV0gPSA1OAogICAgaWYgc25ha2VbMF1bMF0gPT0gMTk6IHNuYWtlWzBdWzBdID0gMQogICAgaWYgc25ha2VbMF1bMV0gPT0gNTk6IHNuYWtlWzBdWzFdID0gMQoKCiAgICBpZiBzbmFrZVswXSBpbiBzbmFrZVsxOl06IGJyZWFrCgogICAgCiAgICBpZiBzbmFrZVswXSA9PSBmb29kOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgZm9vZCA9IFtdCiAgICAgICAgc2NvcmUgKz0gMQogICAgICAgIHdoaWxlIGZvb2QgPT0gW106CiAgICAgICAgICAgIGZvb2QgPSBbcmFuZGludCgxLCAxOCksIHJhbmRpbnQoMSwgNTgpXSAKICAgICAgICAgICAgaWYgZm9vZCBpbiBzbmFrZTogZm9vZCA9IFtdCiAgICAgICAgd2luLmFkZGNoKGZvb2RbMF0sIGZvb2RbMV0sICcqJykKICAgIGVsc2U6ICAgIAogICAgICAgIGxhc3QgPSBzbmFrZS5wb3AoKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIHdpbi5hZGRjaChsYXN0WzBdLCBsYXN0WzFdLCAnICcpCiAgICB3aW4uYWRkY2goc25ha2VbMF1bMF0sIHNuYWtlWzBdWzFdLCAnIycpCiAgICAKY3Vyc2VzLmVuZHdpbigpCnByaW50KCJcblNjb3JlIC0gIiArIHN0cihzY29yZSkpCnByaW50KCJpbnN0YWdyYW06cmlvX3ZhdGFyX1xuIikKCg=='))
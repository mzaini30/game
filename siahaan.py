import base64
exec(base64.b64decode('I2NvZGluZzogdXRmLTgKaW1wb3J0IG9zLHRpbWUKYm9hcmQ9WyIgIiwiICIsIiAiLAogICAgICAgIiAiLCIgIiwiICIsCiAgICAgICAiICIsIiAiLCIgIl0Kb3Muc3lzdGVtKCJjbGVhciIpCnBhdHRlcm49W1s0LDAsOF0sWzEsNCw3XSxbMCwxLDJdLFswLDMsNl0sWzgsNyw2XSxbMiw0LDZdLFszLDQsNV0sWzIsNSw4XV0KbXltdXY9W10KZGVmIGJlc3RtdXYobGFzdG1vdmVzKToKICAgIGdsb2JhbCBib2FyZCxwbGF5ZXIyLHR1cm4scGF0dGVybgogICAgZW10eT1bXQogICAgZm9yIG4sZW5tdSBpbiBlbnVtZXJhdGUoYm9hcmQpOgogICAgICAgIGlmIGVubXUgPT0gcGxheWVyMToKICAgICAgICAgICBlbXR5LmFwcGVuZChuKQogICAgZm9yIGkgaW4gcGF0dGVybjoKICAgICAgaWYgbXltdXY9PVtdOgogICAgICAgIGlmIGxhc3Rtb3ZlcyBpbiBpIGFuZCB0dXJuID09IHBsYXllcjI6CgkgICBmb3IgYiBpbiBpOgoJICAgICAgIGlmIGJvYXJkW2JdID09ICIgIjoKCQkgIGJvYXJkW2JdID0gcGxheWVyMgoJCSAgbXltdXYuYXBwZW5kKGIpO3Jhd19pbnB1dCgiZmlyc3Qgc3RhZ2UiKQogICAgICAgICAgICAgICAgICBwYXR0ZXJuLnJlbW92ZShpKQoJCSAgdHVybj1wbGF5ZXIxCgkJICBicmVhawoKICAgICAgZWxzZToKICAgICAgICBjdG4gPSBUcnVlCiAgICAgICAgZ28gPSAwCiAgICAgICAgaWYgbGFzdG1vdmVzIGluIGkgYW5kIHR1cm4gPT0gcGxheWVyMjoKCSBpZiBpWzBdIGluIGVtdHkgYW5kICBpWzFdIGluIGVtdHk6CiAgICAgICAgICAgIGlmIGlbMF0gbm90IGluIG15bXV2IGFuZCBpWzFdIG5vdCBpbiBteW11diAgYW5kIGlbMl0gbm90IGluIG15bXV2OgogICAgICAgICAgICAgIGZvciBiIGluIGk6CiAgICAgICAgICAgICAgIGlmIGJvYXJkW2JdID09ICIgIjoKICAgICAgICAgICAgICAgICAgcGF0dGVybi5yZW1vdmUoaSk7cmF3X2lucHV0KCIxMSIpCiAgICAgICAgICAgICAgICAgIGJvYXJkW2JdID0gcGxheWVyMgogICAgICAgICAgICAgICAgICBteW11di5hcHBlbmQoYikKICAgICAgICAgICAgICAgICAgYm90bW92ZT1iCiAgICAgICAgICAgICAgICAgIHR1cm49cGxheWVyMQogICAgICAgICAgICAgICAgICBjdG49RmFsc2UKICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgcGF0dGVybi5yZW1vdmUoaSkKICAgICAgICAgZWxpZiBpWzBdIGluIGVtdHkgYW5kIGlbMl0gaW4gZW10eToKCSAgICBpZiBpWzBdIG5vdCBpbiBteW11diBhbmQgaVsxXSBub3QgaW4gbXltdXYgIGFuZCBpWzJdIG5vdCBpbiBteW11djoKICAgICAgICAgICAgICBmb3IgYiBpbiBpOgogICAgICAgICAgICAgICBpZiBib2FyZFtiXSA9PSAiICI6CiAgICAgICAgICAgICAgICAgIHBhdHRlcm4ucmVtb3ZlKGkpO3Jhd19pbnB1dCgiMTIiKQogICAgICAgICAgICAgICAgICBib2FyZFtiXSA9IHBsYXllcjIKICAgICAgICAgICAgICAgICAgbXltdXYuYXBwZW5kKGIpCiAgICAgICAgICAgICAgICAgIGJvdG1vdmU9YgogICAgICAgICAgICAgICAgICB0dXJuPXBsYXllcjEKICAgICAgICAgICAgICAgICAgY3RuPUZhbHNlCiAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgIHBhdHRlcm4ucmVtb3ZlKGkpCgkgZWxpZiBpWzFdIGluIGVtdHkgYW5kIGlbMl0gaW4gZW10eToKCSAgICBpZiBpWzBdIG5vdCBpbiBteW11diBhbmQgaVsxXSBub3QgaW4gbXltdXYgIGFuZCBpWzJdIG5vdCBpbiBteW11djoKICAgICAgICAgICAgICBmb3IgYiBpbiBpOgogICAgICAgICAgICAgICBpZiBib2FyZFtiXSA9PSAiICI6CiAgICAgICAgICAgICAgICAgIHBhdHRlcm4ucmVtb3ZlKGkpO3Jhd19pbnB1dCgiMTMiKQogICAgICAgICAgICAgICAgICBib2FyZFtiXSA9IHBsYXllcjIKICAgICAgICAgICAgICAgICAgbXltdXYuYXBwZW5kKGIpCiAgICAgICAgICAgICAgICAgIGJvdG1vdmU9YgogICAgICAgICAgICAgICAgICB0dXJuPXBsYXllcjEKICAgICAgICAgICAgICAgICAgY3RuPUZhbHNlCiAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgIHBhdHRlcm4ucmVtb3ZlKGkpCgkgZWxzZToKCSAgIHBhc3MKICAgIGZvciBpIGluIHBhdHRlcm46CiAgICAgICAgaWYgbGFzdG1vdmVzIGluIGkgYW5kIHR1cm4gPT0gcGxheWVyMjoKCSAgICBpZiBpWzBdIG5vdCBpbiBteW11diBvciBpWzFdIG5vdCBpbiBteW11diBvciBpWzJdIG5vdCBpbiBteW11djoKCQkgIGZvciBiIGluIGk6CiAgICAgICAgICAgICAgICAgICAgICBpZiBib2FyZFtiXSA9PSAiICI6CgkgICAgICAgICAgICAgICAgICBwYXR0ZXJuLnJlbW92ZShpKQoJICAgICAgICAgICAgICAgICAgYm9hcmRbYl0gPSBwbGF5ZXIyCiAgICAgICAgCSAgICAgICAgICBteW11di5hcHBlbmQoYikKICAgICAgICAJICAgICAgICAgIGJvdG1vdmU9YgogICAgICAgIAkgICAgICAgICAgdHVybj1wbGF5ZXIxCiAgICAgICAgCSAgICAgICAgICBjdG49RmFsc2UKICAgICAgICAJICAgICAgICAgIHJldHVybgogICAgICAgCSAgICBlbHNlOgoJICAgICAgICAgICAgICAgICAgcGF0dGVybi5yZW1vdmUoaSkKbGFzdG1vdmU9MApwbGF5ZXIxPSJceDFiWzE7MzJtWCIKcGxheWVyMj0iXHgxYlsxOzM0bU8iCnR1cm49cGxheWVyMQpwbHk9eyJceDFiWzE7MzJtWCI6InBsYXllcjEiLCJceDFiWzE7MzRtTyI6InBsYXllcjIifQpwcmludCgiXHgxYlsxOzM5bSIpCmNoID0gcmF3X2lucHV0KCJbMV0gLiAxVlMxXG5bMl0gLiBMYXdhbiBCb3RcbnBpbGloYW4gOiAiKQppZiBjaCA9PSAiMSI6CiB3aGlsZSBUcnVlOgogICBib3g9IiIiXHgxYlsxOzMzbSAgICAgIOKVlOKVkOKVkOKVkOKVpuKVkOKVkOKVkOKVpuKVkOKVkOKVkOKVlwogICAgICDilZEge30gXHgxYlsxOzMzbeKVkSB7fSBceDFiWzE7MzNt4pWRIHt9IFx4MWJbMTszM23ilZEKICAgICAg4pWg4pWQ4pWQ4pWQ4pWj4pWQ4pWQ4pWQ4pWj4pWQ4pWQ4pWQ4pWjCiAgICAgIOKVkSB7fSBceDFiWzE7MzNt4pWRIHt9IFx4MWJbMTszM23ilZEge30gXHgxYlsxOzMzbeKVkQogICAgICDilaDilZDilZDilZDilaPilZDilZDilZDilaPilZDilZDilZDilaMKICAgICAg4pWRIHt9IFx4MWJbMTszM23ilZEge30gXHgxYlsxOzMzbeKVkSB7fSBceDFiWzE7MzNt4pWRCiAgICAgIOKVmuKVkOKVkOKVkOKVqeKVkOKVkOKVkOKVqeKVkOKVkOKVkOKVnVx4MWJbMTszOW0iIiIuZm9ybWF0KGJvYXJkWzBdLGJvYXJkWzFdLGJvYXJkWzJdLGJvYXJkWzNdLGJvYXJkWzRdLGJvYXJkWzVdLGJvYXJkWzZdLGJvYXJkWzddLGJvYXJkWzhdKQogICBpZiBib2FyZFswXSA9PSBib2FyZFsxXSA9PSBib2FyZFsyXSBhbmQgYm9hcmRbMF0gIT0gIiAiIG9yIGJvYXJkWzBdID09IGJvYXJkWzNdID09IGJvYXJkWzZdIGFuZCBib2FyZFswXSAhPSAiICIgb3IgIGJvYXJkWzBdID09IGJvYXJkWzRdID09IGJvYXJkWzhdIGFuZCBib2FyZFswXSAhPSAiICI6CiAgICAgIHdpbm5lcj1wbHlbYm9hcmRbMF1dCiAgICAgIHByaW50IChib3gpCiAgICAgIHByaW50ICh3aW5uZXIrIiBNZW5hbmciKQogICAgICBicmVhawogICBlbGlmIGJvYXJkWzFdID09IGJvYXJkWzRdID09IGJvYXJkWzddIGFuZCBib2FyZFsxXSAhPSAiICI6CiAgICAgIHdpbm5lcj1wbHlbYm9hcmRbMV1dCiAgICAgIHByaW50IChib3gpCiAgICAgIHByaW50ICh3aW5uZXIrIiBNZW5hbmciKQogICAgICBicmVhawogICBlbGlmIGJvYXJkWzZdID09IGJvYXJkWzRdID09IGJvYXJkWzJdIGFuZCBib2FyZFs2XSAhPSAiICIgb3IgIGJvYXJkWzZdID09IGJvYXJkWzddID09IGJvYXJkWzhdIGFuZCBib2FyZFs2XSAhPSAiICI6CiAgICAgIHdpbm5lcj1wbHlbYm9hcmRbNl1dCiAgICAgIHByaW50KGJveCkKICAgICAgcHJpbnQgKHdpbm5lcisiIE1lbmFuZyIpCiAgICAgIGJyZWFrCiAgIGVsaWYgYm9hcmRbOF0gPT0gYm9hcmRbNV0gPT0gYm9hcmRbMl0gYW5kIGJvYXJkWzhdICE9ICIgIjoKICAgICAgd2lubmVyPXBseVtib2FyZFs4XV0KICAgICAgcHJpbnQgKGJveCkKICAgICAgcHJpbnQgKHdpbm5lcisiIE1lbmFuZyIpCiAgICAgIGJyZWFrCiAgIGVsaWYgYm9hcmRbM10gPT0gYm9hcmRbNF0gPT0gYm9hcmRbNV0gYW5kIGJvYXJkWzNdICE9ICIgIjoKICAgICAgd2lubmVyPXBseVtib2FyZFs4XV0KICAgICAgcHJpbnQgKGJveCkKICAgICAgcHJpbnQgKHdpbm5lcisiIE1lbmFuZyIpCiAgICAgIGJyZWFrCiAgIGVsaWYgIiAiIG5vdCBpbiBib2FyZDoKICAgICAgcHJpbnQgKGJveCkKICAgICAgcHJpbnQgKCJEcmF3IikKICAgICAgYnJlYWsKCiAgIGlmIHR1cm4gPT0gcGxheWVyMToKICAgICB3aGlsZSBUcnVlOgogICAgICBvcy5zeXN0ZW0oImNsZWFyIikKICAgICAgcHJpbnQgKGJveCkKICAgICAgcHJpbnQgKCJHaWxpcmFuIFBlbWFpbiAxICIpCiAgICAgIGphbGFuPWludChyYXdfaW5wdXQoIktvdGFrIE5vbW9yIDogIikpLTEKICAgICAgaWYgYm9hcmRbamFsYW5dID09ICIgIjoKICAgICAgICAgYm9hcmRbamFsYW5dPXR1cm4KCSBsYXN0bW92ZT1qYWxhbisxCiAgICAgICAgIHR1cm49cGxheWVyMgogICAgICAgICBicmVhawogICAgICBlbHNlOgogICAgICAgICBwcmludCAoIktvdGFrIEluaSBTdWRhaCBEaSBJc2kiKQogICBlbGlmIHR1cm4gPT0gcGxheWVyMjoKICAgICB3aGlsZSBUcnVlOgogICAgICBvcy5zeXN0ZW0oImNsZWFyIikKICAgICAgcHJpbnQgKGJveCkKICAgICAgcHJpbnQgKCJHaWxpcmFuIFBlbWFpbiAyICIpCiAgICAgIGphbGFuPWludChyYXdfaW5wdXQoIktvdGFrIE5vbW9yIDogIikpLTEKICAgICAgaWYgYm9hcmRbamFsYW5dID09ICIgIjoKICAgICAgICAgYm9hcmRbamFsYW5dPXR1cm4KICAgICAgICAgdHVybj1wbGF5ZXIxCgkgbGFzdG1vdmU9amFsYW4rMQogICAgICAgICBicmVhawogICAgICBlbHNlOgogICAgICAgICBwcmludCAoIktvdGFrIEluaSBTdWRhaCBEaSBJc2kiKQogICAgICAgICBpbXBvcnQgdGltZTt0aW1lLnNsZWVwKDIpCmVsc2U6CiB3aGlsZSBUcnVlOgogICBib3g9IiIiXHgxYlsxOzMzbSAgICAgIOKVlOKVkOKVkOKVkOKVpuKVkOKVkOKVkOKVpuKVkOKVkOKVkOKVlwogICAgICDilZEge30gXHgxYlsxOzMzbeKVkSB7fSBceDFiWzE7MzNt4pWRIHt9IFx4MWJbMTszM23ilZEKICAgICAg4pWg4pWQ4pWQ4pWQ4pWj4pWQ4pWQ4pWQ4pWj4pWQ4pWQ4pWQ4pWjCiAgICAgIOKVkSB7fSBceDFiWzE7MzNt4pWRIHt9IFx4MWJbMTszM23ilZEge30gXHgxYlsxOzMzbeKVkQogICAgICDilaDilZDilZDilZDilaPilZDilZDilZDilaPilZDilZDilZDilaMKICAgICAg4pWRIHt9IFx4MWJbMTszM23ilZEge30gXHgxYlsxOzMzbeKVkSB7fSBceDFiWzE7MzNt4pWRCiAgICAgIOKVmuKVkOKVkOKVkOKVqeKVkOKVkOKVkOKVqeKVkOKVkOKVkOKVnVx4MWJbMTszOW0iIiIuZm9ybWF0KGJvYXJkWzBdLGJvYXJkWzFdLGJvYXJkWzJdLGJvYXJkWzNdLGJvYXJkWzRdLGJvYXJkWzVdLGJvYXJkWzZdLGJvYXJkWzddLGJvYXJkWzhdKQoKICAgaWYgYm9hcmRbMF0gPT0gYm9hcmRbMV0gPT0gYm9hcmRbMl0gYW5kIGJvYXJkWzBdICE9ICIgIiBvciBib2FyZFswXSA9PSBib2FyZFszXSA9PSBib2FyZFs2XSBhbmQgYm9hcmRbMF0gIT0gIiAiIG9yICBib2FyZFswXSA9PSBib2FyZFs0XSA9PSBib2FyZFs4XSBhbmQgYm9hcmRbMF0gIT0gIiAiOgogICAgICB3aW5uZXI9cGx5W2JvYXJkWzBdXQogICAgICBwcmludCAoYm94KQogICAgICBwcmludCAod2lubmVyKyIgTWVuYW5nIikKICAgICAgYnJlYWsKICAgZWxpZiBib2FyZFsxXSA9PSBib2FyZFs0XSA9PSBib2FyZFs3XSBhbmQgYm9hcmRbMV0gIT0gIiAiOgogICAgICB3aW5uZXI9cGx5W2JvYXJkWzFdXQogICAgICBwcmludCAoYm94KQogICAgICBwcmludCAod2lubmVyKyIgTWVuYW5nIikKICAgICAgYnJlYWsKICAgZWxpZiBib2FyZFs2XSA9PSBib2FyZFs0XSA9PSBib2FyZFsyXSBhbmQgYm9hcmRbNl0gIT0gIiAiIG9yICBib2FyZFs2XSA9PSBib2FyZFs3XSA9PSBib2FyZFs4XSBhbmQgYm9hcmRbNl0gIT0gIiAiOgogICAgICB3aW5uZXI9cGx5W2JvYXJkWzZdXQogICAgICBwcmludChib3gpCiAgICAgIHByaW50ICh3aW5uZXIrIiBNZW5hbmciKQogICAgICBicmVhawogICBlbGlmIGJvYXJkWzhdID09IGJvYXJkWzVdID09IGJvYXJkWzJdIGFuZCBib2FyZFs4XSAhPSAiICI6CiAgICAgIHdpbm5lcj1wbHlbYm9hcmRbOF1dCiAgICAgIHByaW50IChib3gpCiAgICAgIHByaW50ICh3aW5uZXIrIiBNZW5hbmciKQogICAgICBicmVhawogICBlbGlmICIgIiBub3QgaW4gYm9hcmQ6CiAgICAgIHByaW50IChib3gpCiAgICAgIHByaW50ICgiRHJhdyIpCiAgICAgIGJyZWFrCgogICBpZiB0dXJuID09IHBsYXllcjE6CiAgICAgd2hpbGUgVHJ1ZToKICAgICAgb3Muc3lzdGVtKCJjbGVhciIpCiAgICAgIHByaW50IChib3gpCiAgICAgIHByaW50ICgiR2lsaXJhbiBQZW1haW4gMSAiKQogICAgICBqYWxhbj1pbnQocmF3X2lucHV0KCJLb3RhayBOb21vciA6ICIpKS0xCiAgICAgIGlmIGJvYXJkW2phbGFuXSA9PSAiICI6CiAgICAgICAgIGJvYXJkW2phbGFuXT10dXJuCiAgICAgICAgIGxhc3Rtb3ZlPWphbGFuCiAgICAgICAgIHR1cm49cGxheWVyMgogICAgICAgICBicmVhawogICAgICBlbHNlOgogICAgICAgICBwcmludCAoIktvdGFrIEluaSBTdWRhaCBEaSBJc2kiKQogICBlbGlmIHR1cm4gPT0gcGxheWVyMjoKICAgICBiZXN0bXV2KGxhc3Rtb3ZlKQogICAgIHR1cm49cGxheWVyMQo='))